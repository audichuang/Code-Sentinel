<idea-plugin>
    <id>com.cathaybk.codingassistant</id>
    <name>Code Sentinel</name>
    <version>1.4.0</version>
    <vendor email="audiapplication880208@gmail.com" url="https://github.com/audichuang">AudiChuang</vendor>

    <description><![CDATA[
    <html><body>
    <h2>Code Sentinel: 您的智能編碼與提交守衛</h2>
    <p>Code Sentinel 是一款專為 IntelliJ IDEA 設計的開發者助手插件，旨在通過<b>即時程式碼分析</b>和<b>提交前檢查</b>機制，全方位保障您的程式碼品質、統一團隊規範，並顯著提升開發與提交流程的效率。</p>

    <hr/>

    <h3>核心功能</h3>
    
    <b>🚀 即時檢查與快速修復 (編碼時)</b>
    <ul>
        <li><b>規範哨兵:</b> 在您輸入時，即時捕捉不符合預設規範的程式碼（例如：API MsgID 格式、缺少 Javadoc 等）。</li>
        <li><b>智能修復:</b> 對檢測到的問題提供上下文感知的快速修復建議 (Quick Fix via Alt+Enter / Option+Enter)，一鍵生成或修正程式碼。</li>
    </ul>

    <b>🛡️ 提交前守衛 (Git Commit 時 - 可選)</b>
    <ul>
        <li><b>Git 分支檢查 (可選):</b> 自動執行 `git fetch` 並比對目標分支，防止基於過時分支提交，降低合併衝突風險。</li>
        <li><b>程式碼品質門禁 (可選):</b> 全面掃描待提交的程式碼變更，確保符合團隊自訂的程式碼規範。</li>
        <li><b>問題看板:</b> 在專用工具視窗 ("Code Sentinel 檢查") 清晰列出所有檢查發現的問題點，一目了然。</li>
        <li><b>批量修復 ("Fix All"):</b> 提供強大的 "一鍵修復" 功能，嘗試自動修正所有可修復的問題，節省您的寶貴時間。</li>
    </ul>
    
    <b>💡 智能輔助</b>
    <ul>
        <li><b>Javadoc 生成器 (可選):</b> 自動為方法或類別生成 Javadoc 註解。支持生成包含完整標籤 (<code>@param</code>, <code>@return</code>) 的結構，或僅包含核心描述的最小結構，可在設定中切換。</li>
    </ul>

    <hr/>

    <h3>高度可配置</h3>
    <p>您可以根據團隊或個人需求，在 <code>Settings &gt; Tools &gt; Code Sentinel 設定</code> 中靈活配置：</p>
    <ul>
        <li>啟用/禁用 Git 分支檢查</li>
        <li>啟用/禁用提交前的程式碼規範檢查</li>
        <li>選擇 Javadoc 的生成風格 (完整/最小)</li>
        <li>設定需要檢查的目標分支</li>
    </ul>

    <p>讓 Code Sentinel 成為您編碼過程中的得力助手和品質守護者！</p>

    </body></html>
    ]]></description>

    <change-notes><![CDATA[
    <b>v1.4.0</b>
    <ul>
        <li>優化記憶體資源使用，減少資源洩漏風險。</li>
        <li>改善 PSI 元素處理邏輯，提高穩定性。</li>
        <li>為主要工具類實現批次處理和緩存機制。</li>
        <li>強化資源釋放機制，避免長時間運行時效能衰退。</li>
        <li>低記憶體環境下自動調整工作模式，提高適應性。</li>
    </ul>
    <br/>
    <b>v1.3.0</b>
    <ul>
        <li>插件更名為 "Code Sentinel"。</li>
        <li>新增設定選項：可開關 Git 分支落後檢查。</li>
        <li>新增設定選項：可開關程式碼規範檢查。</li>
        <li>新增設定選項：可配置 Javadoc 生成方式 (完整/最小)。</li>
        <li>設定頁面 UI 優化，分區顯示並加入範例說明。</li>
        <li>增強設定中目標分支名稱的驗證規則。</li>
        <li>移除設定成功時的冗餘提示彈窗。</li>
        <li>修復 Javadoc 生成中的換行符問題。</li>
        <li>(舊) 問題面板界面優化，移除搜尋框，修復 HTML 顯示問題，提高檢查執行效率。</li> 
    </ul>
    <br/>
    <b>v1.2.0</b>
    <ul>
        <li>增加對25.1版本的支持，新增bean加入註解功能</li>
    </ul>
    <br/>
    <b>v1.1.0</b>
    <ul>
        <li>優化效能，修正已知問題，改善使用者體驗</li>
    </ul>
    <br/>
    <b>v1.0.0</b>
    <ul>
        <li>初始版本，提供API註解檢查和Service關聯功能</li>
    </ul>
    ]]></change-notes>

    <!-- 更新 until-build 到一個較新的版本或保持通用 -->
    <idea-version since-build="231"/>

    <!-- 依賴關係 -->
    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.java</depends>

    <extensions defaultExtensionNs="com.intellij">
        <!-- Notification group for Code Sentinel -->
        <notificationGroup id="Code Sentinel" 
                          displayType="BALLOON"/>
        
        <!-- 1. 原有的 API MsgID 檢查器 -->
        <localInspection language="JAVA"
                         displayName="API MsgID檢查"
                         groupName="Code Sentinel"
                         enabledByDefault="true"
                         level="WARNING"
                         shortName="ApiMsgIdInspection"
                         implementationClass="com.cathaybk.codingassistant.inspection.ApiMsgIdInspection"/>

        <!-- ======================================== -->
        <!-- 2. 新增的 注入欄位 Javadoc 檢查器        -->
        <!--    (所有註解都已移到標籤外部)          -->
        <!-- ======================================== -->
        <localInspection language="JAVA"
                         displayName="注入的欄位缺少 Javadoc"
                         groupName="Code Sentinel"
                         enabledByDefault="true"
                         level="WARNING"
                         shortName="InjectedFieldJavadocInspection"
                         implementationClass="com.cathaybk.codingassistant.inspection.InjectedFieldJavadocInspection"/>

        <!-- ======================================== -->
        <!-- 5. 新增創建 DTO 模板的 Intention        -->
        <!-- ======================================== -->
        <intentionAction>
            <className>com.cathaybk.codingassistant.intention.CreateDtoIntentionAction</className>
            <category>Code Sentinel/模板生成</category> <!-- 分類會顯示在 Intention 設定中 -->
        </intentionAction>

        <!-- ======================================== -->
        <!-- 3. 新增 Commit 前檢查處理器           -->
        <!-- ======================================== -->
        <checkinHandlerFactory implementation="com.cathaybk.codingassistant.vcs.CathayBkCheckinHandlerFactory"/>

        <!-- ======================================== -->
        <!-- 4. 新增 Git 設置組件                   -->
        <!-- ======================================== -->
        <projectService serviceImplementation="com.cathaybk.codingassistant.settings.GitSettings"/>
        <applicationConfigurable 
                             groupId="tools" 
                             instance="com.cathaybk.codingassistant.settings.GitSettingsConfigurable"
                             id="com.cathaybk.codingassistant.settings.GitSettingsConfigurable" 
                             displayName="Code Sentinel"/>
        
        <!-- ======================================== -->
        <!-- 5. 新增緩存管理器服務                   -->
        <!-- ======================================== -->
        <projectService serviceImplementation="com.cathaybk.codingassistant.cache.InspectionCacheManager"/>

    </extensions>
</idea-plugin>